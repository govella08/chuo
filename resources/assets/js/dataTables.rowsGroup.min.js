!function(u){ShowedDataSelectorModifier={order:"current",page:"current",search:"applied"},GroupedColumnsOrderDir="asc";function o(e,r){this.table=e.table(),this.columnsForGrouping=r,this.orderOverrideNow=!1,this.mergeCellsNeeded=!1,this.order=[];var t=this;e.on("order.dt",function(e,r){t.orderOverrideNow?t.orderOverrideNow=!1:(t.orderOverrideNow=!0,t._updateOrderAndDraw())}),e.on("preDraw.dt",function(e,r){t.mergeCellsNeeded&&(t.mergeCellsNeeded=!1,t._mergeCells())}),e.on("column-visibility.dt",function(e,r){t.mergeCellsNeeded=!0}),e.on("search.dt",function(e,r){t.mergeCellsNeeded=!0}),e.on("page.dt",function(e,r){t.mergeCellsNeeded=!0}),e.on("length.dt",function(e,r){t.mergeCellsNeeded=!0}),e.on("xhr.dt",function(e,r){t.mergeCellsNeeded=!0}),this._updateOrderAndDraw()}o.prototype={setMergeCells:function(){this.mergeCellsNeeded=!0},mergeCells:function(){this.setMergeCells(),this.table.draw()},_getOrderWithGroupColumns:function(e,t){void 0===t&&(t=GroupedColumnsOrderDir);var r=this,n=this.columnsForGrouping.map(function(e){return r.table.column(e).index()}),o=e.filter(function(e){return 0<=n.indexOf(e[0])}),i=e.filter(function(e){return n.indexOf(e[0])<0}),d=o.map(function(e){return e[0]}),s=n.map(function(e){var r=d.indexOf(e);return 0<=r?[e,o[r][1]]:[e,t]});return s.push.apply(s,i),s},_getInjectedMonoSelectWorkaround:function(e){if(1===e.length){var r=e[0][0],t=this.order.map(function(e){return e[0]}).indexOf(r);if(0<=t)return[[r,this._toogleDirection(this.order[t][1])]]}return e},_mergeCells:function(){var e=this.table.columns(this.columnsForGrouping,ShowedDataSelectorModifier).indexes().toArray(),r=this.table.rows(ShowedDataSelectorModifier)[0].length;this._mergeColumn(0,r-1,e)},_mergeColumn:function(e,r,t){var n=t.slice();currentColumn=n.shift(),currentColumn=this.table.column(currentColumn,ShowedDataSelectorModifier);var o,i=currentColumn.nodes(),d=currentColumn.data(),s=e;for(o=e+1;o<=r;++o)d[o]===d[s]?u(i[o]).hide():(u(i[s]).show(),u(i[s]).attr("rowspan",o-1-s+1),0<n.length&&this._mergeColumn(s,o-1,n),s=o);u(i[s]).show(),u(i[s]).attr("rowspan",o-1-s+1),0<n.length&&this._mergeColumn(s,o-1,n)},_toogleDirection:function(e){return"asc"==e?"desc":"asc"},_updateOrderAndDraw:function(){this.mergeCellsNeeded=!0;var e=this.table.order();e=this._getInjectedMonoSelectWorkaround(e),this.order=this._getOrderWithGroupColumns(e),this.table.order(u.extend(!0,Array(),this.order)),this.table.draw()}},u.fn.dataTable.RowsGroup=o,u.fn.DataTable.RowsGroup=o,u(document).on("init.dt",function(e,r){if("dt"===e.namespace){var t=new u.fn.dataTable.Api(r);if(r.oInit.rowsGroup||u.fn.dataTable.defaults.rowsGroup){options=r.oInit.rowsGroup?r.oInit.rowsGroup:u.fn.dataTable.defaults.rowsGroup;var n=new o(t,options);u.fn.dataTable.Api.register("rowsgroup.update()",function(){return n.mergeCells(),this}),u.fn.dataTable.Api.register("rowsgroup.updateNextDraw()",function(){return n.setMergeCells(),this})}}})}(jQuery);